# <Chapter 7> ìŠ¤í”„ë§ ì‚¼ê°í˜•ê³¼ ì„¤ì • ì •ë³´

# ğŸ“šTopic Covered

- IoCì™€ í”„ë ˆì„ ì›Œí¬, ë¼ì´ë¸ŒëŸ¬ë¦¬
- ìƒì„±ìë¥¼ í†µí•œ ì˜ì¡´ì„± ì£¼ì… @Autowired ë¹„êµ
- AOP

# ğŸ“˜IoCì™€ í”„ë ˆì„ ì›Œí¬, ë¼ì´ë¸ŒëŸ¬ë¦¬

### ğŸ¤”ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì™€ ìŠ¤í”„ë§ ì‚¼ê°í˜•ì˜ ê´€ê³„?

ğŸ‘‰ ì˜ì–´ ë¬¸ì¥ê³¼ ì•ŒíŒŒë²³ì˜ ê´€ê³„, ì¦‰ ìŠ¤í”„ë§ ì‚¼ê°í˜•ì´ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ ë¶€ë¶„ ì§‘í•©ì´ë¼ê³  ë³¼ ìˆ˜ ìˆìŒ

âš ï¸ë³¸ì¸ì€ ìŠ¤í”„ë§ì˜ ì‚¼ê°í˜•ì´ë¼ê³  í‘œí˜„í•˜ê¸°ì—ëŠ” ë­”ê°€ ì¶”ìƒì ì´ë‹ˆ, ì´í•´í•˜ê¸° ì‰½ê²Œ ìŠ¤í”„ë§ì˜ ì‚¼ëŒ€ì¥ì´ë¼ê³  í•˜ê² ë‹¤. 

ê·¸ëŸ¼ ì§€ê¸ˆë¶€í„° **ìŠ¤í”„ë§ì˜ ì‚¼ëŒ€ì¥(IoC/DI, AOP, PSA)**ë¥¼ ì°¨ê·¼ì°¨ê·¼ ì†Œê°œí•´ë³´ê² ë‹¤

## ğŸ“–IoC/DI: ì œì–´ì˜ ì—­ì „/ì˜ì¡´ì„± ì£¼ì…

- ì „ì˜ ì…ë¬¸ê°•ì˜ì—ì„œ, ì˜ì¡´ì„±ì€ â€œì‚¬ìš©í•œë‹¤â€ë¼ê³  í•˜ì˜€ë‹¤. ê·¸ëŸ°ë° ì´ê²ƒì„ ìë°”ë¡œ í‘œí˜„í•˜ìë©´ **ì˜ì¡´ì„±ì€ new**ì´ê³ , newë¥¼ ì‹¤í–‰í•˜ëŠ” Carì™€ Tire ì‚¬ì´ì—ì„œ Carê°€ Tireì— ì˜ì¡´í•œë‹¤ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

```java
new Car();

...
static Class Car {
	Tire tire = new Tire(); // ê°ì²´ CarëŠ” ì˜ì¡´í•˜ëŠ” Tireê°€ ì—†ìœ¼ë©´ ì•Œë§¹ì´ê°€ ì—†ë‹¤ -> ì‰½ê²Œ ìƒê°í•˜ë©´, ì¸í„°í˜ì´ìŠ¤ì™€ ë¶€í’ˆ ê´€ê³„...?
}
...
```

- ì‚¬ì‹¤, ì´ê²ƒì€ ì†Œí”„íŠ¸ì›¨ì–´ê³µí•™ì—ì„œëŠ” HAS-A ê´€ê³„ë¼ê³  í•˜ëŠ”ë°, whole-part ê´€ê³„, ê·¸ë¦¬ê³  ì „ì²´ê°€ ì‚¬ë¼ì§€ë©´ ë¶€ë¶„ì˜ ì¡´ì¬ ìœ ë¬´ì— ë”°ë¼ Aggregation(ì§‘í•©) ë˜ëŠ” Composition(êµ¬ì„±) ê´€ê³„ë¡œ ë‚˜ë‰œë‹¤.
    - Aggregation: ì•½í•œ ê²°í•©ë ¥ì„ ê°€ì§, ì¦‰ ì „ì²´ê°€ ì‚¬ë¼ì ¸ë„ ë¶€ë¶„ì€ ì¡´ì¬
    - Composition: ê°•í•œ ê²°í•©ë ¥ì„ ê°€ì§, ì „ì²´ê°€ ì‚¬ë¼ì§€ë©´ ë¶€ë¶„ë„ ì‚¬ë¼ì§
        
        ex) ë¹„ë¹”ë°¥
        

## ğŸ“‘newë¥¼ ì‚¬ìš©í•´ ì˜ì¡´ì„±ì„ ì£¼ì…í•œ í”„ë¡œì íŠ¸

### ğŸ’»Tire í´ë˜ìŠ¤ â†’ ë¸Œëœë“œíƒ€ì´ì–´ë“¤ì˜ ìƒìœ„í´ë˜ìŠ¤

```java
package expert001_01;

public interface Tire {
    String getBrand();
}
```

### ğŸ’»KoreaTire í´ë˜ìŠ¤ â†’ ë¶€í’ˆ ì—­í• 

```java
package expert001_01;

public class KoreaTire implements Tire {

    @Override
    public String getBrand() {
        return "ì½”ë¦¬ì•„ íƒ€ì´ì–´";
    }
}
```

### ğŸ’»AmericaTire í´ë˜ìŠ¤ â†’ ë¶€í’ˆ ì—­í• 

```java
package expert001_01;

public class AmericaTire implements Tire{
    @Override
    public String getBrand() {
        return "ë¯¸êµ­ íƒ€ì´ì–´";
    }
}
```

### ğŸ’»Car í´ë˜ìŠ¤ â†’ Tireë¥¼ HAS-A ê´€ê³„ë¡œ ê°–ëŠ” í´ë˜ìŠ¤(Composition)

```java
package expert001_01;

public class Car {
    Tire tire; // Tire í´ë˜ìŠ¤ ê°ì²´ ìƒì„±

    public Car() {
        tire = new KoreaTire();
        // tire = new AmericaTire();
    }

    public String getTireBrand() {
        return "ì¥ì°©ëœ íƒ€ì´ì–´: " + tire.getBrand();
    }
}
```

### ğŸ’»Driver í´ë˜ìŠ¤ â†’ Carë¥¼ ì‚¬ìš©í•˜ëŠ” ê°ì²´

```java
package expert001_01;

public class Driver {
    public static void main(String[] args) {
        Car car = new Car(); 
        System.out.println(car.getTireBrand()); 
	// O/P: ì¥ì°©ëœ íƒ€ì´ì–´: ì½”ë¦¬ì•„ íƒ€ì´ì–´
    }
}
```

- ìš´ì „ìëŠ” Car ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ”ë°, carì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ Car í´ë˜ìŠ¤ëŠ” Tireí´ë˜ìŠ¤ë¥¼ ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì—, Tire ì¸í„°í˜ì´ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ë©”ì†Œë“œê°€ ì‹¤í–‰ë  ê²ƒì´ë‹¤
    - ì´ë•Œ, KoreaTire í´ë˜ìŠ¤ëŠ” Tire ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í–ˆê¸° ë•Œë¬¸ì—, ì¶œë ¥ ê²°ê³¼ëŠ” `ì¥ì°©ëœ íƒ€ì´ì–´: ì½”ë¦¬ì•„ íƒ€ì´ì–´` ê°€ ë‚˜ì˜¬ ê²ƒì´ë‹¤

## ğŸ“‘newë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ì„± ì£¼ì…

- ë§ê·¸ëŒ€ë¡œ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ newë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ê³ ì°¨ì›ì˜ ëª¨ë“ˆ(ì—¬ê¸°ì„œëŠ” Driver)ì—ì„œ newë¥¼ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ì¸ìì— ì˜ì¡´í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ë„£ìœ¼ë©´ ëœë‹¤

### ğŸ’»TIre ì¸í„°í˜ì´ìŠ¤

```java
package expert001_02;

public interface Tire {
    String getBrand();
    }
```

### ğŸ’»KoreaTire í´ë˜ìŠ¤

```java
package expert001_02;

public class KoreaTire implements Tire {

    @Override
    public String getBrand() {
        return "ì½”ë¦¬ì•„ íƒ€ì´ì–´";
    }
}
```

### ğŸ’»AmericaTire í´ë˜ìŠ¤

```java
package expert001_02;

public class AmericaTire implements Tire{

    @Override
    public String getBrand() {
        return "ë¯¸êµ­ íƒ€ì´ì–´";
    }
}
```

### ğŸ’»Car í´ë˜ìŠ¤

```java
package expert001_02;

public class Car {
    Tire tire;

    public Car(Tire tire) {
        this.tire = tire; // newë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ëŠ” ëŒ€ì‹  ìƒì„±ì íŒŒë¼ë¯¸í„°ì— ì˜ì¡´í•˜ëŠ” Tire í´ë˜ìŠ¤ë¥¼ ë„£ìŒ
    }

    public String getTireBrand() {
        return "ì¥ì°©ëœ íƒ€ì´ì–´: " + tire.getBrand();
    }
}
```

### ğŸ’»Driver í´ë˜ìŠ¤

```java
package expert001_02;

public class Driver {
    public static void main(String[] args) {
        Tire tire = new KoreaTire(); // Tireí´ë˜ìŠ¤ ë‹¤í˜•ì„±ì„ í™œìš©í•œ KoreaTire ê°ì²´ ìƒì„±
        // Tire tire = new AmericaTire();
        Car car = new Car(tire); // car ê°ì²´ ìƒì„±

        System.out.println(car.getTireBrand()); // O/P: ì½”ë¦¬ì•„ íƒ€ì´ì–´
    }
}
```

## ğŸ“–ìƒì„±ìë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ì£¼ì…í•œ ì½”ë“œì˜ ì¥ì 

- Driverì˜ **í•˜ìœ„ ëª¨ë“ˆì¸ Car í´ë˜ìŠ¤**ê°€ newë¥¼ í†µí•´ KoreaTireë¥¼ ìƒì‚°í• ì§€ AmericaTireë¥¼ ìƒì‚°í• ì§€ ê²°ì •í•˜ë©´ **ì½”ë“œì˜ ìœ ì—°ì„±ì´ ë–¨ì–´ì§!**

ìš°ë¦¬ëŠ” ìŠ¤í”„ë§ ê°•ì˜ì—ì„œ DIP(Dependency Inversion Principle)ì›ì¹™ì´ ê°ì²´ì—ì„œ ì–´ë–¤ Classë¥¼ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê·¸ ëŒ€ìƒì˜ **ìƒìœ„ ìš”ì†Œ(ì¶”ìƒ í´ë˜ìŠ¤ or ì¸í„°í˜ì´ìŠ¤)ë¡œ ì°¸ì¡°í•˜ë¼ëŠ” ì›ì¹™**ì´ë¼ê³  ë°°ì› ì—ˆë‹¤.

ğŸ”ê·¸ë ‡ë‹¤ë©´, ì´ ì˜ˆì œë¥¼ ì ìš©í•´ë³´ìë©´, Carê°€ ì˜ì¡´í•˜ëŠ” Tire í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì°¸ì¡°(ë˜ëŠ” ì˜ì¡´)í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ìƒì„±ìì˜ ì¸ìì— ì˜ì¡´í•˜ëŠ” Tire í´ë˜ìŠ¤ë¥¼ ì£¼ì…í•¨ìœ¼ë¡œì¨ ìƒìœ„ ëª¨ë“ˆì¸ Driver í´ë˜ìŠ¤ì—ì„œ Car ê°ì²´ë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ Tire í´ë˜ìŠ¤ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.

ğŸ‘‰ì´ì™¸ì—ë„, ê¸°ì¡´ì˜ ëª¨ë“ˆí™”ëœ ê²ƒ ë§ê³  **ìƒˆë¡œ ëª¨ë“ˆë¡œ ë§Œë“  ì½”ë“œë§Œ ë°°í¬**í•˜ë©´ ë˜ë¯€ë¡œ, **ì»´íŒŒì¼ ë° ë¹Œë“œì˜ ë¹„ìš©ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤ëŠ” ì¥ì **ì´ ìˆìŒ!

## ğŸ“–ìŠ¤í”„ë§ì„ í†µí•œ ì˜ì¡´ì„± ì£¼ì…: XML íŒŒì¼ ì‚¬ìš©

- Driver í´ë˜ìŠ¤ì˜ ì½”ë“œë§Œ ë‹¬ë¼ì¡Œìœ¼ë¯€ë¡œ, ì´ê²ƒë§Œ ë‹¤ë£¬ë‹¤

### ğŸ’»Driver í´ë˜ìŠ¤

```java
package expert002;

// ì¢…í•© ì‡¼í•‘ëª°(ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬)ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” íŒ¨í‚¤ì§€
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Driver {
    public static void main(String[] args) {
        // ì¢…í•© ì‡¼í•‘ëª°ì— ëŒ€í•œ ì •ë³´
        ApplicationContext context = new ClassPathXmlApplicationContext("expert002/expert002.xml");
        
        // ì¢…í•© ì‡¼í•‘ëª°ì—ì„œ Carë¥¼ êµ¬ë§¤
        Car car = context.getBean("car", Car.class); 

        // ì¢…í•© ì‡¼í•‘ëª°ì—ì„œ Tireë¥¼ êµ¬ë§¤
        Tire tire = context.getBean("tire", Tire.class);

        car.setTire(tire);

        System.out.println(car.getTireBrand());
    }
}
```

- getBeanì„ í†µí•´ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ

### ğŸ“„expert002.xml

```xml
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="tire" class="expert002.KoreaTire"></bean>

    <bean id="americaTire" class="expert002.AmericaTire"></bean>

    <bean id="car" class="expert002.Car"></bean>

</beans>
```

### ì¥ì 

- ëª¨ë“ˆì„ ì¬ì»´íŒŒì¼/ì¬ë°°í¬í•˜ì§€ ì•Šì•„ë„ XMLíŒŒì¼ë§Œ ìˆ˜ì •í•˜ë©´ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë°”ê¿€ ìˆ˜ ìˆìŒ

ğŸ¤”ê·¸ëŸ°ë°, XMLíŒŒì¼ì€ íƒœê·¸ê°€ ìˆì–´ì„œ ê°€ë…ì„±ì´ ë–¨ì–´ì ¸ @Responsebody ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ XMLì„ JSONíŒŒì¼ë¡œ ë³€í™˜í•´ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤

- ë˜í•œ, ëª¨ë“ˆì„ ë³€ê²½í•˜ê³ ì í•  ë•Œ, í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ `<bean id="name" ... </bean>` ì˜ ì´ë¦„ íƒœê·¸ë§Œ ë³€ê²½í•´ì£¼ë©´ ë˜ê¸° ë•Œë¬¸ì— ì•„ì£¼ ê°„í¸í•˜ë‹¤.

## ğŸ“–ìŠ¤í”„ë§ì„ í†µí•œ ì˜ì¡´ì„± ì£¼ì…: @Autowiredë¥¼ í†µí•œ ì†ì„± ì£¼ì…

- @AutowiredëŠ” setter ë©”ì†Œë“œë¡œ tire ì†ì„±ì„ ì´ˆê¸°í™”í•´ì£¼ì§€ ì•Šê³  ê°•ì œë¡œ ì˜ì¡´ í´ë˜ìŠ¤ì— ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ëŠ” ê²ƒì„ ë§í•˜ëŠ”ë°, ì´ê²ƒì´ ì•„ë˜ì™€ ê°™ì´ ìŠ¤í”„ë§ ë¹ˆê³¼ ê´€ë ¨ì´ ìˆë‹¤.

> @AutowiredëŠ” **type ë§¤ì¹­**ì„ ìš°ì„ ìœ¼ë¡œ í•˜ê³ , ê·¸ ë‹¤ìŒì— XMLíŒŒì¼ì—ì„œ ì‘ì„±í•œ â€œbean idâ€ë¡œ ë§¤ì¹­ì„ í•œë‹¤.
> 

ğŸ¤”ë§Œì•½ bean idê°€ ì—†ê³  Tire ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°™ì€ í•˜ìœ„í´ë˜ìŠ¤ê°€ ìˆìœ¼ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

â—ë‹µì€, **No unique beanì´ë¼ëŠ” ì—ëŸ¬**ê°€ ëœ¨ë©´ì„œ ê°ì²´ë¥¼ ê´€ë¦¬í•´ ì¤„ ìˆ˜ê°€ ì—†ë‹¤

ğŸ‘‰ë”°ë¼ì„œ, type class ë§ê³ ë„, í•­ìƒ bean íƒœê·¸ì˜ id ì†ì„±ì„ ì‘ì„±í•˜ëŠ” ìŠµê´€ì„ ë“¤ì´ì.

# ğŸ“˜AOP(Aspect-Oriented Programming)

- ìŠ¤í”„ë§ DIê°€ newë¥¼ í†µí•œ ì˜ì¡´ì„± ì£¼ì…ì´ë¼ë©´, ìŠ¤í”„ë§ AOPëŠ” ë¡œì§(code)ì˜ ì£¼ì…ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

### ğŸ”–íš¡ë‹¨ ê´€ì‹¬ì‚¬(cross-cutting concern)

- ë‹¤ìˆ˜ì˜ ëª¨ë“ˆì— **ê³µí†µì **ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ë¶€ë¶„ì´ **ë°˜ë³µì ìœ¼ë¡œ ì¡´ì¬**í•˜ëŠ” ê²ƒ
    - mySQLê°™ì€ DBMS ì‹œìŠ¤í…œì—ì„œ insert, update, delete, select ì¿¼ë¦¬ ì—°ì‚°ìê°€ í•­ìƒ ë°˜ë³µí•´ì„œ ë“±ì¥í•˜ëŠ” ê²ƒë„ í¬í•¨

> ë°˜ë³µ/ì¤‘ë³µì€ ë¶„ë¦¬í•´ì„œ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ë¼
> 
- ì½”ë“œ = í•µì‹¬ ê´€ì‹¬ì‚¬ + íš¡ë‹¨ ê´€ì‹¬ì‚¬,  ì—¬ê¸°ì„œ í•µì‹¬ ê´€ì‹¬ì‚¬ëŠ” ëª¨ë“ˆë³„ë¡œ íŠ¹ì •í•œ ì½”ë“œê°€ ì‘ì„±ëœ ê³³ì„ ë§í•œë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ë‚¨ìì™€ ì—¬ìë¼ëŠ” ê°ì²´ê°€ ìˆëŠ”ë° ë‘˜ì˜ ì½”ë“œ ì§„í–‰ ìˆœì„œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤
    
    ë‚¨ì: ì—´ì‡ ë¡œ ë¬¸ì„ ì—´ê³  ì§‘ì— ë“¤ì–´ê°„ë‹¤ â†’ ì»´í“¨í„°ë¡œ ê²Œì„ì„ í•œë‹¤ â†’ ì†Œë“±í•˜ê³  ì”ë‹¤ â†’ ìë¬¼ì‡ ë¥¼ ì ê·¸ê³  ì§‘ì„ ë‚˜ì„ ë‹¤
    
    ì—¬ì: ì—´ì‡ ë¡œ ë¬¸ì„ ì—´ê³  ì§‘ì— ë“¤ì–´ê°„ë‹¤ â†’ ìš”ë¦¬ë¥¼ í•œë‹¤ â†’ ì†Œë“±í•˜ê³  ì”ë‹¤ â†’ ìë¬¼ì‡ ë¥¼ ì ê·¸ê³  ì§‘ì„ ë‚˜ì„ ë‹¤
    

ìœ„ì™€ ê°™ì´ ë‹¤ë¥¸ ê°ì²´ì— ê³µí†µì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ë¶€ë¶„ì„ íš¡ë‹¨ ê´€ì‹¬ì‚¬ë¼ê³  í•˜ê³ , ë°‘ì¤„ ì¹œ íŠ¹ë³„í•œ ë¶€ë¶„ì„ í•µì‹¬ ê´€ì‹¬ì‚¬ë¼ê³  í•œë‹¤